local keywordHandler = KeywordHandler:new()
local npcHandler = NpcHandler:new(keywordHandler)
NpcSystem.parseParameters(npcHandler)
local talkState = {}
function onCreatureAppear(cid) npcHandler:onCreatureAppear(cid) end
function onCreatureDisappear(cid) npcHandler:onCreatureDisappear(cid) end
function onCreatureSay(cid, type, msg) npcHandler:onCreatureSay(cid, type, msg) end
function onThink() npcHandler:onThink() end
 
local level = 500 -- Level preciso pra entrar para akatsuki
local itemid = 5808 -- id do coração
local quantidade = 6 -- quantos cerebro e preciso
local bonushp = 300000 -- quanto de bonus de life vai ganha
local bonusmp = 30000 -- quanto de bonus de mana vai ganha
local config = {
--[Vocation] = ( Nova Vocation, New Outfit )
[1] = { 1, 1027},
[2] = { 2, 1027},
[3] = { 3, 1027},
[4] = { 4, 1027},
[5] = { 5, 1027},
[6] = { 6, 1027},
[7] = { 7, 1027},
[8] = { 8, 1027},
[9] = { 9, 1027},
[10] = { 10, 1027},
[11] = { 11, 1027},
[12] = { 12, 1027},
[1077] = { 1077, 1027},
[1082] = { 1082, 1027},

[13] = { 13, 1028},
[14] = { 14, 1028},
[15] = { 15, 1028},
[16] = { 16, 1028},
[17] = { 17, 1028},
[18] = { 18, 1028},
[19] = { 19, 1028},
[20] = { 20, 1028},
[21] = { 21, 1028},
[22] = { 22, 1028},
[23] = { 23, 1028},
[24] = { 24, 1028},
[1075] = { 1075, 1028},

[25] = { 25, 1032},
[26] = { 26, 1032},
[27] = { 27, 1032},
[28] = { 28, 1032},
[29] = { 29, 1032},
[30] = { 30, 1032},
[31] = { 31, 1032},
[32] = { 32, 1032},
[33] = { 33, 1032},
[1071] = { 1071, 1032},
[1080] = { 1080, 1032},

[34] = { 34, 1029},
[35] = { 35, 1029},
[36] = { 36, 1029},
[37] = { 37, 1029},
[38] = { 38, 1029},
[39] = { 39, 1029},
[40] = { 40, 1029},
[41] = { 41, 1029},
[42] = { 42, 1029},
[1076] = { 1076, 1029},

[50] = { 50, 1037},
[51] = { 51, 1037},
[52] = { 52, 1037},
[53] = { 53, 1037},
[54] = { 54, 1037},
[55] = { 55, 1037},
[56] = { 56, 1037},
[57] = { 57, 1037},
[58] = { 58, 1037},
[59] = { 59, 1037},
[60] = { 60, 1037},

[70] = { 70, 1033},
[71] = { 71, 1033},
[72] = { 72, 1033},
[73] = { 73, 1033},
[74] = { 74, 1033},
[75] = { 75, 1033},
[76] = { 76, 1033},
[77] = { 77, 1033},
[78] = { 78, 1033},

[90] = { 90, 1035},
[91] = { 91, 1035},
[92] = { 92, 1035},
[93] = { 93, 1035},
[94] = { 94, 1035},
[95] = { 95, 1035},
[96] = { 96, 1035},
[97] = { 97, 1035},
[98] = { 98, 1035},

[110] = { 110, 1047},
[111] = { 111, 1047},
[112] = { 112, 1047},
[113] = { 113, 1047},
[114] = { 114, 1047},
[115] = { 115, 1047},
[116] = { 116, 1047},
[1088] = { 1088, 1047},

[130] = { 130, 1036},
[131] = { 131, 1036},
[132] = { 132, 1036},
[133] = { 133, 1036},
[134] = { 134, 1036},
[135] = { 135, 1036},
[136] = { 136, 1036},
[137] = { 137, 1036},
[138] = { 138, 1036},
[139] = { 139, 1036},
[140] = { 140, 1036},
[141] = { 141, 1036},
[1074] = { 1074, 1336},

[150] = { 150, 1034},
[151] = { 151, 1034},
[152] = { 152, 1034},
[153] = { 153, 1034},
[154] = { 154, 1034},
[155] = { 155, 1034},
[156] = { 156, 1034},
[157] = { 157, 1034},
[158] = { 158, 1034},
[159] = { 159, 1034},
[160] = { 160, 1034},

[170] = { 170, 1044},
[171] = { 171, 1044},
[172] = { 172, 1044},
[173] = { 173, 1044},
[174] = { 174, 1044},
[175] = { 175, 1044},
[176] = { 176, 1044},
[177] = { 177, 1044},
[178] = { 178, 1044},
[179] = { 179, 1044},
[180] = { 180, 1044},

[190] = { 190, 1030},
[191] = { 191, 1030},
[192] = { 192, 1030},
[193] = { 193, 1030},
[194] = { 194, 1030},
[195] = { 195, 1030},
[196] = { 196, 1030},
[197] = { 197, 1030},
[198] = { 198, 1030},
[199] = { 199, 1030},
[200] = { 200, 1030},

[201] = { 201, 1046},
[202] = { 202, 1046},
[203] = { 203, 1046},
[204] = { 204, 1046},
[205] = { 205, 1046},
[206] = { 206, 1046},
[207] = { 207, 1046},
[208] = { 208, 1046},

[209] = { 209, 1049},
[210] = { 210, 1049},
[211] = { 211, 1049},
[212] = { 212, 1049},
[213] = { 213, 1049},
[214] = { 214, 1049},
[215] = { 215, 1049},

[216] = { 216, 1045},
[217] = { 217, 1045},
[218] = { 218, 1045},
[219] = { 219, 1045},
[220] = { 220, 1045},
[221] = { 221, 1045},
[222] = { 222, 1045},

[223] = { 223, 173},
[224] = { 224, 173},
[225] = { 225, 173},
[226] = { 226, 173},
[227] = { 227, 173},
[228] = { 228, 173},
[229] = { 229, 173},
[230] = { 230, 173},

[300] = { 300, 1031},
[301] = { 301, 1031},
[302] = { 302, 1031},
[303] = { 303, 1031},
[304] = { 304, 1031},
[1089] = { 1089, 1031},
[1083] = { 1083, 1031},
[1081] = { 1081, 1031},

[305] = { 305, 1048},
[306] = { 306, 1048},
[307] = { 307, 1048},
[308] = { 308, 1048},
[309] = { 309, 1048},
[310] = { 310, 1048},
[311] = { 311, 1048},
[312] = { 312, 1048},
[313] = { 313, 1048},
[314] = { 314, 1048},

[400] = { 400, 1041},
[401] = { 401, 1041},
[402] = { 402, 1041},
[403] = { 403, 1041},
[404] = { 404, 1041},
[405] = { 405, 1041},
[406] = { 406, 1041},
[407] = { 407, 1041},
[408] = { 408, 1041},
[409] = { 409, 1041},
[410] = { 410, 1041},

[500] = { 500, 1043},
[501] = { 501, 1043},
[502] = { 502, 1043},
[503] = { 503, 1043},
[504] = { 504, 1043},
[505] = { 505, 1043},
[506] = { 506, 1043},
[507] = { 507, 1043},

[520] = { 520, 1051},
[521] = { 521, 1051},
[522] = { 522, 1051},
[523] = { 523, 1051},
[524] = { 524, 1051},
[525] = { 525, 1051},
[526] = { 526, 1051},
[527] = { 527, 1051},
[528] = { 528, 1051},
[529] = { 529, 1051},
[1079] = { 1079, 1051},

[530] = { 530, 181},
[531] = { 531, 181},
[532] = { 532, 181},
[533] = { 533, 181},
[534] = { 534, 181},

[536] = { 536, 1038},
[537] = { 537, 1038},
[538] = { 538, 1038},
[539] = { 539, 1038},
[540] = { 540, 1038},
[541] = { 541, 1038},

[620] = { 620, 429},
[621] = { 621, 429},
[622] = { 622, 429},
[623] = { 623, 429},
[624] = { 624, 429},
[625] = { 625, 429},
[626] = { 626, 429},
[627] = { 627, 429},
[628] = { 628, 429},
[629] = { 629, 429},

[630] = { 630, 182},
[631] = { 631, 182},
[632] = { 632, 182},
[633] = { 633, 182},
[634] = { 634, 182},
[635] = { 635, 182},

[640] = { 640, 183},
[641] = { 641, 183},
[642] = { 642, 183},
[643] = { 643, 183},
[644] = { 644, 183},
[645] = { 645, 183},
[646] = { 646, 183},
[647] = { 647, 183},
[1085] = { 1085, 183},

[652] = { 652, 184},
[653] = { 653, 184},
[654] = { 654, 184},
[655] = { 655, 184},
[656] = { 656, 184},
[657] = { 657, 184},
[658] = { 658, 184},

[660] = { 660, 1012},
[661] = { 661, 1012},
[662] = { 662, 1012},
[663] = { 663, 1012},
[664] = { 664, 1012},
[665] = { 665, 1012},
[666] = { 666, 1012},
[667] = { 667, 1012},


[670] = { 670, 185},
[671] = { 671, 185},
[672] = { 672, 185},
[673] = { 673, 185},
[674] = { 674, 185},
[675] = { 675, 185},

[680] = { 680, 186},
[681] = { 681, 186},
[682] = { 682, 186},
[683] = { 683, 186},
[684] = { 684, 186},

[690] = { 690, 1042},
[691] = { 691, 1042},
[692] = { 692, 1042},
[693] = { 693, 1042},
[694] = { 694, 1042},
[695] = { 695, 1042},
[696] = { 696, 1042},
[697] = { 697, 1042},
[1086] = { 1086, 1290},

[700] = { 700, 187},
[701] = { 701, 187},
[702] = { 702, 187},
[703] = { 703, 187},
[704] = { 704, 187},
[705] = { 705, 187},

[710] = { 710, 1089},
[711] = { 711, 1089},
[712] = { 712, 1089},
[713] = { 713, 1089},
[714] = { 714, 1089},
[715] = { 715, 1089},

[720] = { 720, 188},
[721] = { 721, 188},
[722] = { 722, 188},
[723] = { 723, 188},
[724] = { 724, 188},
[725] = { 725, 188},
[726] = { 726, 188},
[727] = { 727, 188},
[1070] = { 1070, 188},
[1073] = { 1073, 188},

[730] = { 730, 1039},
[731] = { 731, 1039},
[732] = { 732, 1039},
[733] = { 733, 1039},
[734] = { 734, 1039},
[735] = { 735, 1039},
[736] = { 736, 1039},
[737] = { 737, 1039},
[738] = { 738, 1039},
[739] = { 739, 1039},
[740] = { 740, 1039},

[750] = { 750, 1040},
[751] = { 751, 1040},
[752] = { 752, 1040},
[753] = { 753, 1040},
[754] = { 754, 1040},
[755] = { 755, 1040},
[756] = { 756, 1040},

[760] = { 760, 1050},
[761] = { 761, 1050},
[762] = { 762, 1050},
[763] = { 763, 1050},
[764] = { 764, 1050},
[765] = { 765, 1050},

[770] = { 770, 190},
[771] = { 771, 190},
[772] = { 772, 190},
[773] = { 773, 190},
[774] = { 774, 190},
[775] = { 775, 190},

[780] = { 780, 191},
[781] = { 781, 191},
[782] = { 782, 191},
[783] = { 783, 191},
[784] = { 784, 191},
[785] = { 785, 191},
[1078] = { 1078, 191},

[790] = { 790, 192},
[791] = { 791, 192},
[792] = { 792, 192},
[793] = { 793, 192},
[794] = { 794, 192},
[795] = { 795, 192},

[800] = { 800, 193},
[801] = { 801, 193},
[802] = { 802, 193},
[803] = { 803, 193},
[804] = { 804, 193},
[805] = { 805, 193},
[1084] = { 1084, 193},

[810] = { 810, 194},
[811] = { 811, 194},
[812] = { 812, 194},
[813] = { 813, 194},
[814] = { 814, 194},
[815] = { 815, 194},

[820] = { 820, 1217},
[821] = { 821, 1217},
[822] = { 822, 1217},
[823] = { 823, 1217},
[824] = { 824, 1217},
[825] = { 825, 1217},
[1087] = { 1087, 1217},

[830] = { 830, 199},
[831] = { 831, 199},
[832] = { 832, 199},
[833] = { 833, 199},
[834] = { 834, 199},
[835] = { 835, 199},

[840] = { 840, 213},
[841] = { 841, 213},
[842] = { 842, 213},
[843] = { 843, 213},
[844] = { 844, 213},

[850] = { 850, 217},
[851] = { 851, 217},
[852] = { 852, 217},
[853] = { 853, 217},
[854] = { 854, 217},

[860] = { 860, 222},
[861] = { 861, 222},
[862] = { 862, 222},
[863] = { 863, 222},
[864] = { 864, 222},

[870] = { 860, 227},
[871] = { 861, 227},
[872] = { 862, 227},
[873] = { 863, 227},

[880] = { 880, 977},
[881] = { 881, 977},
[882] = { 882, 977},
[883] = { 883, 977},
[884] = { 884, 977},
[885] = { 885, 977},
[886] = { 886, 977},

[890] = { 890, 1127},
[891] = { 891, 1127},
[892] = { 892, 1127},
[893] = { 893, 1127},
[894] = { 894, 1127},

[900] = { 890, 230},
[901] = { 891, 230},
[902] = { 892, 230},

[910] = { 910, 1233},
[911] = { 911, 1233},
[912] = { 912, 1233},
[913] = { 913, 1233},
[914] = { 914, 1233},
[915] = { 915, 1233},
[916] = { 916, 1233},
[917] = { 917, 1233},
[918] = { 918, 1233},

[920] = { 920, 1215},
[921] = { 921, 1215},
[922] = { 922, 1215},
[923] = { 923, 1215},
[924] = { 924, 1215},
[925] = { 925, 1215},

[930] = { 930, 994},
[931] = { 931, 994},
[932] = { 932, 994},
[933] = { 933, 994},
[934] = { 934, 994},
[935] = { 935, 994},

[940] = { 940, 229},
[941] = { 941, 229},
[942] = { 942, 229},
[943] = { 943, 229},
[944] = { 944, 229},
[945] = { 945, 229},
[946] = { 946, 229},

[950] = { 950, 237},
[951] = { 951, 237},
[952] = { 952, 237},
[953] = { 953, 237},
[954] = { 954, 237},
[955] = { 955, 237},

[960] = { 960, 241},
[961] = { 961, 241},
[962] = { 962, 241},
[963] = { 963, 241},
[964] = { 964, 241},
[965] = { 965, 241},

[970] = { 970, 242},
[971] = { 971, 242},
[972] = { 972, 242},
[973] = { 973, 242},
[974] = { 974, 242},
[975] = { 975, 242},

[980] = { 980, 244},
[981] = { 981, 244},
[982] = { 982, 244},
[983] = { 983, 244},

[990] = { 990, 245},
[991] = { 991, 245},
[992] = { 992, 245},
[993] = { 993, 245},
[994] = { 994, 245},
[995] = { 995, 245},
[996] = { 996, 245},

[1000] = { 1000, 250},
[1001] = { 1001, 250},
[1002] = { 1002, 250},
[1003] = { 1003, 250},
[1004] = { 1004, 250},
[1005] = { 1005, 250},

[1010] = { 1010, 254},
[1011] = { 1011, 254},
[1012] = { 1012, 254},
[1013] = { 1013, 254},
[1014] = { 1014, 254},

[1020] = { 1020, 264},
[1021] = { 1021, 264},
[1022] = { 1022, 264},
[1023] = { 1023, 264},
[1024] = { 1024, 264},

[1030] = { 1030, 1216},
[1031] = { 1031, 1216},
[1032] = { 1032, 1216},
[1033] = { 1033, 1216},
[1034] = { 1034, 1216},
[1035] = { 1035, 1216},
[1036] = { 1036, 1216},
[1037] = { 1037, 1216},
[1038] = { 1038, 1216},
[1039] = { 1039, 1216},

[1040] = { 1040, 271},
[1041] = { 1041, 271},
[1042] = { 1042, 271},
[1043] = { 1043, 271},
[1044] = { 1044, 271},
[1045] = { 1045, 271},
[1046] = { 1046, 271},
[1047] = { 1047, 271},
[1072] = { 1072, 271},

[1050] = { 1050, 274},
[1051] = { 1051, 274},
[1052] = { 1052, 274},
[1053] = { 1053, 274},
[1054] = { 1054, 274},
[1055] = { 1055, 274},
[1056] = { 1056, 274},

[1060] = { 1060, 275},
[1061] = { 1061, 275},
[1062] = { 1062, 275},
}
function creatureSayCallback(cid, type, msg)
if(not npcHandler:isFocused(cid)) then
 return false
end
 
local talkUser = NPCHANDLER_CONVBEHAVIOR == CONVERSATION_DEFAULT and 0 or cid
 
 
if msgcontains(msg, 'anbu') then
    if getPlayerVocation(cid) ~= config then
        if getPlayerStorageValue(cid, 85798723243) == -1 then
            if getPlayerLevel(cid) >= level then
                selfSay('Tem certeza de que deseja participar da Anbu?', cid)
                talkState[talkUser] = 1
            else
                selfSay('Voce ainda e muito fraco, fale comigo quando estiver level '..level..'.', cid)
            end
        else
            selfSay('Voce ja faz parte da Akatsuki ou Anbu!', cid)
        end
    else
        selfSay('Nao preciso de voce agora!', cid)
    end
end
 
if talkState[talkUser] == 1 and msgcontains(msg, 'yes') then
    selfSay('Para provar sua lealdade voce deve trazer '..quantidade..' {cerebros}.', cid)
    talkState[talkUser] = 2
end
 
if talkState[talkUser] == 2 and msgcontains(msg, 'cerebros') then
    if getPlayerItemCount(cid, 5808) >= 6 then
    local voc = config[getPlayerVocation(cid)]
        doPlayerSetVocation(cid, voc[1])
    local outfit = {lookType = voc[2]}
        doCreatureChangeOutfit(cid, outfit)
        setCreatureMaxHealth(cid, getCreatureMaxHealth(cid)+bonushp)
        setCreatureMaxMana(cid, getCreatureMaxMana(cid)+bonusmp)
        doCreatureAddHealth(cid, getCreatureMaxHealth(cid))
        doPlayerRemoveItem(cid, 5808, 6)
        doCreatureAddMana(cid, getCreatureMaxMana(cid))
        setPlayerStorageValue(cid,85798723243,1)
        db.executeQuery("UPDATE `players` SET `name` = '[Anbu] "..getCreatureName(cid).."' WHERE `id` = "..getPlayerGUID(cid)..";")
        addEvent(doRemoveCreature, 5*1000, cid, true) 
        doPlayerSendTextMessage(cid,25,'Voce sera deslogado em 5 segundos!')  
        selfSay('Parabens agora voce faz parte da anbu.', cid)
        talkState[talkUser] = 0
    else
        selfSay('Nao adianta me enganar, voce nao tem '..quantidade..' cerebros ainda.', cid)
    end
end
return true
end
npcHandler:setCallback(CALLBACK_MESSAGE_DEFAULT, creatureSayCallback)
npcHandler:addModule(FocusModule:new())