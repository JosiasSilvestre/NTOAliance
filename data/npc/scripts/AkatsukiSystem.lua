local keywordHandler = KeywordHandler:new()
local npcHandler = NpcHandler:new(keywordHandler)
NpcSystem.parseParameters(npcHandler)
local talkState = {}
function onCreatureAppear(cid) npcHandler:onCreatureAppear(cid) end
function onCreatureDisappear(cid) npcHandler:onCreatureDisappear(cid) end
function onCreatureSay(cid, type, msg) npcHandler:onCreatureSay(cid, type, msg) end
function onThink() npcHandler:onThink() end
 
local level = 500 -- Level preciso pra entrar para akatsuki
local itemid = 5943 -- id do coração
local quantidade = 6 -- quantos hearts e preciso
local bonushp = 300000 -- quanto de bonus de life vai ganha
local bonusmp = 30000 -- quanto de bonus de mana vai ganha
local config = {
--[Vocation] = ( Nova Vocation, New Outfit )
[1] = { 1, 1279},
[2] = { 2, 1279},
[3] = { 3, 1279},
[4] = { 4, 1279},
[5] = { 5, 1279},
[6] = { 6, 1279},
[7] = { 7, 1279},
[8] = { 8, 1279},
[9] = { 9, 1279},
[10] = { 10, 1279},
[11] = { 11, 1279},
[12] = { 12, 1279},
[1077] = { 1077, 1279},
[1082] = { 1082, 1279},

[13] = { 13, 1333},
[14] = { 14, 1333},
[15] = { 15, 1333},
[16] = { 16, 1333},
[17] = { 17, 1333},
[18] = { 18, 1333},
[19] = { 19, 1333},
[20] = { 20, 1333},
[21] = { 21, 1333},
[22] = { 22, 1333},
[23] = { 23, 1333},
[24] = { 24, 1333},
[1075] = { 1075, 1333},

[25] = { 25, 1067},
[26] = { 26, 1067},
[27] = { 27, 1067},
[28] = { 28, 1067},
[29] = { 29, 1067},
[30] = { 30, 1067},
[31] = { 31, 1067},
[32] = { 32, 1067},
[33] = { 33, 1067},
[1071] = { 1071, 1067},
[1080] = { 1080, 1067},

[34] = { 34, 1280},
[35] = { 35, 1280},
[36] = { 36, 1280},
[37] = { 37, 1280},
[38] = { 38, 1280},
[39] = { 39, 1280},
[40] = { 40, 1280},
[41] = { 41, 1280},
[42] = { 42, 1280},
[1076] = { 1076, 1280},

[50] = { 50, 1284},
[51] = { 51, 1284},
[52] = { 52, 1284},
[53] = { 53, 1284},
[54] = { 54, 1284},
[55] = { 55, 1284},
[56] = { 56, 1284},
[57] = { 57, 1284},
[58] = { 58, 1284},
[59] = { 59, 1284},
[60] = { 60, 1284},

[70] = { 70, 754},
[71] = { 71, 754},
[72] = { 72, 754},
[73] = { 73, 754},
[74] = { 74, 754},
[75] = { 75, 754},
[76] = { 76, 754},
[77] = { 77, 754},
[78] = { 78, 754},

[90] = { 90, 1282},
[91] = { 91, 1282},
[92] = { 92, 1282},
[93] = { 93, 1282},
[94] = { 94, 1282},
[95] = { 95, 1282},
[96] = { 96, 1282},
[97] = { 97, 1282},
[98] = { 98, 1282},

[110] = { 110, 729},
[111] = { 111, 729},
[112] = { 112, 729},
[113] = { 113, 729},
[114] = { 114, 729},
[115] = { 115, 729},
[116] = { 116, 729},
[1088] = { 1088, 729},

[130] = { 130, 1283},
[131] = { 131, 1283},
[132] = { 132, 1283},
[133] = { 133, 1283},
[134] = { 134, 1283},
[135] = { 135, 1283},
[136] = { 136, 1283},
[137] = { 137, 1283},
[138] = { 138, 1283},
[139] = { 139, 1283},
[140] = { 140, 1283},
[141] = { 141, 1283},
[1074] = { 1074, 1283},

[150] = { 150, 1296},
[151] = { 151, 1296},
[152] = { 152, 1296},
[153] = { 153, 1296},
[154] = { 154, 1296},
[155] = { 155, 1296},
[156] = { 156, 1296},
[157] = { 157, 1296},
[158] = { 158, 1296},
[159] = { 159, 1296},
[160] = { 160, 1296},

[170] = { 170, 1289},
[171] = { 171, 1289},
[172] = { 172, 1289},
[173] = { 173, 1289},
[174] = { 174, 1289},
[175] = { 175, 1289},
[176] = { 176, 1289},
[177] = { 177, 1289},
[178] = { 178, 1289},
[179] = { 179, 1289},
[180] = { 180, 1289},

[190] = { 190, 722},
[191] = { 191, 722},
[192] = { 192, 722},
[193] = { 193, 722},
[194] = { 194, 722},
[195] = { 195, 722},
[196] = { 196, 722},
[197] = { 197, 722},
[198] = { 198, 722},
[199] = { 199, 722},
[200] = { 200, 722},

[201] = { 201, 1293},
[202] = { 202, 1293},
[203] = { 203, 1293},
[204] = { 204, 1293},
[205] = { 205, 1293},
[206] = { 206, 1293},
[207] = { 207, 1293},
[208] = { 208, 1293},

[209] = { 209, 706},
[210] = { 210, 706},
[211] = { 211, 706},
[212] = { 212, 706},
[213] = { 213, 706},
[214] = { 214, 706},
[215] = { 215, 706},

[216] = { 216, 1295},
[217] = { 217, 1295},
[218] = { 218, 1295},
[219] = { 219, 1295},
[220] = { 220, 1295},
[221] = { 221, 1295},
[222] = { 222, 1295},

[223] = { 223, 713},
[224] = { 224, 713},
[225] = { 225, 713},
[226] = { 226, 713},
[227] = { 227, 713},
[228] = { 228, 713},
[229] = { 229, 713},
[230] = { 230, 713},

[300] = { 300, 705},
[301] = { 301, 705},
[302] = { 302, 705},
[303] = { 303, 705},
[304] = { 304, 705},
[1089] = { 1089, 705},
[1083] = { 1083, 705},
[1081] = { 1081, 705},

[305] = { 305, 61},
[306] = { 306, 61},
[307] = { 307, 61},
[308] = { 308, 61},
[309] = { 309, 61},
[310] = { 310, 61},
[311] = { 311, 61},
[312] = { 312, 61},
[313] = { 313, 61},
[314] = { 314, 61},

[400] = { 400, 1123},
[401] = { 401, 1123},
[402] = { 402, 1123},
[403] = { 403, 1123},
[404] = { 404, 1123},
[405] = { 405, 1123},
[406] = { 406, 1123},
[407] = { 407, 1123},
[408] = { 408, 1123},
[409] = { 409, 1123},
[410] = { 410, 1123},

[500] = { 500, 1291},
[501] = { 501, 1291},
[502] = { 502, 1291},
[503] = { 503, 1291},
[504] = { 504, 1291},
[505] = { 505, 1291},
[506] = { 506, 1291},
[507] = { 507, 1291},

[520] = { 520, 1052},
[521] = { 521, 1052},
[522] = { 522, 1052},
[523] = { 523, 1052},
[524] = { 524, 1052},
[525] = { 525, 1052},
[526] = { 526, 1052},
[527] = { 527, 1052},
[528] = { 528, 1052},
[529] = { 529, 1052},
[1079] = { 1079, 1052},

[530] = { 530, 1286},
[531] = { 531, 1286},
[532] = { 532, 1286},
[533] = { 533, 1286},
[534] = { 534, 1286},

[536] = { 536, 1302},
[537] = { 537, 1302},
[538] = { 538, 1302},
[539] = { 539, 1302},
[540] = { 540, 1302},
[541] = { 541, 1302},

[620] = { 620, 66},
[621] = { 621, 66},
[622] = { 622, 66},
[623] = { 623, 66},
[624] = { 624, 66},
[625] = { 625, 66},
[626] = { 626, 66},
[627] = { 627, 66},
[628] = { 628, 66},
[629] = { 629, 66},

[630] = { 630, 1401},
[631] = { 631, 1401},
[632] = { 632, 1401},
[633] = { 633, 1401},
[634] = { 634, 1401},
[635] = { 635, 1401},

[640] = { 640, 1189},
[641] = { 641, 1189},
[642] = { 642, 1189},
[643] = { 643, 1189},
[644] = { 644, 1189},
[645] = { 645, 1189},
[646] = { 646, 1189},
[647] = { 647, 1189},
[1085] = { 1085, 1189},

[652] = { 652, 1188},
[653] = { 653, 1188},
[654] = { 654, 1188},
[655] = { 655, 1188},
[656] = { 656, 1188},
[657] = { 657, 1188},
[658] = { 658, 1188},

[660] = { 660, 1013},
[661] = { 661, 1013},
[662] = { 662, 1013},
[663] = { 663, 1013},
[664] = { 664, 1013},
[665] = { 665, 1013},
[666] = { 666, 1013},
[667] = { 667, 1013},


[670] = { 670, 68},
[671] = { 671, 68},
[672] = { 672, 68},
[673] = { 673, 68},
[674] = { 674, 68},
[675] = { 675, 68},

[680] = { 680, 1281},
[681] = { 681, 1281},
[682] = { 682, 1281},
[683] = { 683, 1281},
[684] = { 684, 1281},

[690] = { 690, 1290},
[691] = { 691, 1290},
[692] = { 692, 1290},
[693] = { 693, 1290},
[694] = { 694, 1290},
[695] = { 695, 1290},
[696] = { 696, 1290},
[697] = { 697, 1290},
[1086] = { 1086, 1290},

[700] = { 700, 71},
[701] = { 701, 71},
[702] = { 702, 71},
[703] = { 703, 71},
[704] = { 704, 71},
[705] = { 705, 71},

[710] = { 710, 1089},
[711] = { 711, 1089},
[712] = { 712, 1089},
[713] = { 713, 1089},
[714] = { 714, 1089},
[715] = { 715, 1089},

[720] = { 720, 718},
[721] = { 721, 718},
[722] = { 722, 718},
[723] = { 723, 718},
[724] = { 724, 718},
[725] = { 725, 718},
[726] = { 726, 718},
[727] = { 727, 718},
[1070] = { 1070, 718},
[1073] = { 1073, 718},

[730] = { 730, 1287},
[731] = { 731, 1287},
[732] = { 732, 1287},
[733] = { 733, 1287},
[734] = { 734, 1287},
[735] = { 735, 1287},
[736] = { 736, 1287},
[737] = { 737, 1287},
[738] = { 738, 1287},
[739] = { 739, 1287},
[740] = { 740, 1287},

[750] = { 750, 69},
[751] = { 751, 69},
[752] = { 752, 69},
[753] = { 753, 69},
[754] = { 754, 69},
[755] = { 755, 69},
[756] = { 756, 69},

[760] = { 760, 168},
[761] = { 761, 168},
[762] = { 762, 168},
[763] = { 763, 168},
[764] = { 764, 168},
[765] = { 765, 168},

[770] = { 770, 70},
[771] = { 771, 70},
[772] = { 772, 70},
[773] = { 773, 70},
[774] = { 774, 70},
[775] = { 775, 70},

[780] = { 780, 73},
[781] = { 781, 73},
[782] = { 782, 73},
[783] = { 783, 73},
[784] = { 784, 73},
[785] = { 785, 73},
[1078] = { 1078, 73},

[790] = { 790, 75},
[791] = { 791, 75},
[792] = { 792, 75},
[793] = { 793, 75},
[794] = { 794, 75},
[795] = { 795, 75},

[800] = { 800, 76},
[801] = { 801, 76},
[802] = { 802, 76},
[803] = { 803, 76},
[804] = { 804, 76},
[805] = { 805, 76},
[1084] = { 1084, 76},

[810] = { 810, 77},
[811] = { 811, 77},
[812] = { 812, 77},
[813] = { 813, 77},
[814] = { 814, 77},
[815] = { 815, 77},

[820] = { 820, 164},
[821] = { 821, 164},
[822] = { 822, 164},
[823] = { 823, 164},
[824] = { 824, 164},
[825] = { 825, 164},
[1087] = { 1087, 164},

[830] = { 830, 78},
[831] = { 831, 78},
[832] = { 832, 78},
[833] = { 833, 78},
[834] = { 834, 78},
[835] = { 835, 78},

[840] = { 840, 81},
[841] = { 841, 81},
[842] = { 842, 81},
[843] = { 843, 81},
[844] = { 844, 81},

[850] = { 850, 106},
[851] = { 851, 106},
[852] = { 852, 106},
[853] = { 853, 106},
[854] = { 854, 106},

[860] = { 860, 1143},
[861] = { 861, 1143},
[862] = { 862, 1143},
[863] = { 863, 1143},
[864] = { 864, 1143},

[870] = { 860, 1146},
[871] = { 861, 1146},
[872] = { 862, 1146},
[873] = { 863, 1146},

[880] = { 880, 171},
[881] = { 881, 171},
[882] = { 882, 171},
[883] = { 883, 171},
[884] = { 884, 171},
[885] = { 885, 171},
[886] = { 886, 171},

[890] = { 890, 1070},
[891] = { 891, 1070},
[892] = { 892, 1070},
[893] = { 893, 1070},
[894] = { 894, 1070},

[900] = { 890, 82},
[901] = { 891, 82},
[902] = { 892, 82},

[910] = { 910, 1232},
[911] = { 911, 1232},
[912] = { 912, 1232},
[913] = { 913, 1232},
[914] = { 914, 1232},
[915] = { 915, 1232},
[916] = { 916, 1232},
[917] = { 917, 1232},
[918] = { 918, 1232},

[920] = { 920, 1218},
[921] = { 921, 1218},
[922] = { 922, 1218},
[923] = { 923, 1218},
[924] = { 924, 1218},
[925] = { 925, 1218},

[930] = { 930, 993},
[931] = { 931, 993},
[932] = { 932, 993},
[933] = { 933, 993},
[934] = { 934, 993},
[935] = { 935, 993},

[940] = { 940, 83},
[941] = { 941, 83},
[942] = { 942, 83},
[943] = { 943, 83},
[944] = { 944, 83},
[945] = { 945, 83},
[946] = { 946, 83},

[950] = { 950, 84},
[951] = { 951, 84},
[952] = { 952, 84},
[953] = { 953, 84},
[954] = { 954, 84},
[955] = { 955, 84},

[960] = { 960, 103},
[961] = { 961, 103},
[962] = { 962, 103},
[963] = { 963, 103},
[964] = { 964, 103},
[965] = { 965, 103},

[970] = { 970, 1074},
[971] = { 971, 1074},
[972] = { 972, 1074},
[973] = { 973, 1074},
[974] = { 974, 1074},
[975] = { 975, 1074},

[980] = { 980, 85},
[981] = { 981, 85},
[982] = { 982, 85},
[983] = { 983, 85},

[990] = { 990, 1074},
[991] = { 991, 1074},
[992] = { 992, 1074},
[993] = { 993, 1074},
[994] = { 994, 1074},
[995] = { 995, 1074},
[996] = { 996, 1074},

[1000] = { 1000, 86},
[1001] = { 1001, 86},
[1002] = { 1002, 86},
[1003] = { 1003, 86},
[1004] = { 1004, 86},
[1005] = { 1005, 86},

[1010] = { 1010, 105},
[1011] = { 1011, 105},
[1012] = { 1012, 105},
[1013] = { 1013, 105},
[1014] = { 1014, 105},

[1020] = { 1020, 1339},
[1021] = { 1021, 1339},
[1022] = { 1022, 1339},
[1023] = { 1023, 1339},
[1024] = { 1024, 1339},

[1030] = { 1030, 1236},
[1031] = { 1031, 1236},
[1032] = { 1032, 1236},
[1033] = { 1033, 1236},
[1034] = { 1034, 1236},
[1035] = { 1035, 1236},
[1036] = { 1036, 1236},
[1037] = { 1037, 1236},
[1038] = { 1038, 1236},
[1039] = { 1039, 1236},

[1040] = { 1040, 94},
[1041] = { 1041, 94},
[1042] = { 1042, 94},
[1043] = { 1043, 94},
[1044] = { 1044, 94},
[1045] = { 1045, 94},
[1046] = { 1046, 94},
[1047] = { 1047, 94},
[1072] = { 1072, 94},

[1050] = { 1050, 102},
[1051] = { 1051, 102},
[1052] = { 1052, 102},
[1053] = { 1053, 102},
[1054] = { 1054, 102},
[1055] = { 1055, 102},
[1056] = { 1056, 102},

[1060] = { 1060, 172},
[1061] = { 1061, 172},
[1062] = { 1062, 172},
}
function creatureSayCallback(cid, type, msg)
if(not npcHandler:isFocused(cid)) then
 return false
end
 
local talkUser = NPCHANDLER_CONVBEHAVIOR == CONVERSATION_DEFAULT and 0 or cid
 
 
if msgcontains(msg, 'akatsuki') then
    if getPlayerVocation(cid) ~= config then
        if getPlayerStorageValue(cid, 85798723243) == -1 then
            if getPlayerLevel(cid) >= level then
                selfSay('Tem certeza de que deseja participar da Akatsuki?', cid)
                talkState[talkUser] = 1
            else
                selfSay('Voce ainda e muito fraco, fale comigo quando estiver level '..level..'.', cid)
            end
        else
            selfSay('Voce ja faz parte da Akatsuki ou Anbu!', cid)
        end
    else
        selfSay('Nao preciso de voce agora!', cid)
    end
end
 
if talkState[talkUser] == 1 and msgcontains(msg, 'yes') then
    selfSay('Para provar sua lealdade voce deve trazer '..quantidade..' {hearts}.', cid)
    talkState[talkUser] = 2
end
 
if talkState[talkUser] == 2 and msgcontains(msg, 'hearts') then
    if getPlayerItemCount(cid, 5943) >= 6 then
    local voc = config[getPlayerVocation(cid)]
        doPlayerSetVocation(cid, voc[1])
    local outfit = {lookType = voc[2]}
        doCreatureChangeOutfit(cid, outfit)
        setCreatureMaxHealth(cid, getCreatureMaxHealth(cid)+bonushp)
        setCreatureMaxMana(cid, getCreatureMaxMana(cid)+bonusmp)
        doCreatureAddHealth(cid, getCreatureMaxHealth(cid))
        doPlayerRemoveItem(cid, 5943, 6)
        doCreatureAddMana(cid, getCreatureMaxMana(cid))
        setPlayerStorageValue(cid,85798723243,1)
        db.executeQuery("UPDATE `players` SET `name` = '[Akatsuki] "..getCreatureName(cid).."' WHERE `id` = "..getPlayerGUID(cid)..";")
        addEvent(doRemoveCreature, 5*1000, cid, true) 
        doPlayerSendTextMessage(cid,25,'Voce sera deslogado em 5 segundos!')  
        selfSay('Parabens agora voce faz parte da akatsuki.', cid)
        talkState[talkUser] = 0
    else
        selfSay('Nao adianta me enganar, voce nao tem '..quantidade..' coracoes ainda.', cid)
    end
end
return true
end
npcHandler:setCallback(CALLBACK_MESSAGE_DEFAULT, creatureSayCallback)
npcHandler:addModule(FocusModule:new())